
#include <assert.h>
#include <stdio.h>

#include "jtag-io.h"


/*
1085.26% 2824959 3054727921378055 c0000000 d62ff1f0 29586270 B[ 30]
HIT!!!!
2305479776166675 c0000000 d62ff1f0 29586270 B[ 30]
1024241782403210 c0000000 d62ff1f0 29586270 B[ 20]
Fast forward first by 29031507855
1088.64% 2826627 3064236672116018 00000000 bdaa5648 4a87397f B[ 86]
Window size is 326069051
Hit 2299755048670005[30]B 1024178198938265[20]B, delta 326069051
00000000 a00005a0 487544aa -> 41e447f2 e59143be 09d3250b
00000000 a00005a0 487544aa -> 41e447f2 e59143be 09d3250b

R 2299755048670005 1 80000000 3e201e02 61603e2b
R 2305479776166675 1 c0000000 d62ff1f0 29586270

R 1024178198938265 1 0 a00005a0 487544aa
R 1024241782403210 1 c0000000 d62ff1f0 29586270

Big gap:

R 2299884665220456 0 40000000 77de6613 3d0ac49a
R 2299884930310927 1 0 2bbe8c92 feb4c4a3
R 2299885035413482 1 40000000 46511c17 a226d308
R 2305352759564784 0 80000000 ae627179 444ed5e9
R 2305353103540207 0 0 aa43d0dd e065b94a
R 2305448190040917 1 80000000 cad62248 5e00ded9

Fillins:

R 2299755048670005 1 80000000 3e201e02 61603e2b
R 2300183923030725 1 40000000 f545d6d0 b4de438f
R 2300426892627855 1 80000000 dc753d94 85410d1a
R 2300839822527510 1 80000000 9de93187 625aafcc
R 2300890880953500 1 c0000000 985850f8 33be6374
R 2301120957229020 1 0 ce6ea253 51889a40
R 2301562538618490 1 c0000000 b788fbc0 fa5c466d *
R 2302126643941440 1 80000000 737a77d6 e33090e0
R 2302420472013705 1 40000000 84804054 20794d26
R 2302996916705970 1 40000000 f9709214 736ef42e
R 2303032805534400 1 40000000 6fae74f 56dec749
R 2302996916705970 1 40000000 f9709214 736ef42e
R 2303032805534400 1 40000000 6fae74f 56dec749
R 2303560089151065 1 40000000 d0b0fc5b e6cf57ad
R 2303854779676545 1 40000000 d88498d f10a9a25
R 2303915446785255 1 c0000000 66156f2a b1107c32
R 2303937256706700 1 80000000 7d043c13 ab56e71e
R 2304004224174540 1 40000000 54eebd65 50ea64b7
R 2304336960039105 1 c0000000 5cd021d8 5fcd065e
R 2304389581313850 1 0 2e939c5a b6b19c9c
R 2304392776120140 1 0 a9f4990c 1e98009c
R 2304843200587620 1 c0000000 a03e832c 64a3952e
R 2304922395524220 1 40000000 ed51601e b0602b15
R 2305119727728900 1 c0000000 65417729 5610dba8
R 2305145393463930 1 40000000 b01417e3 5ac6a5a6
R 2305187950009845 1 0 1ccfe453 48fab579
R 2305244170505670 1 0 b0279b32 e77e4948
R 2305416192701730 1 0 a00005a0 487544aa
R 2305479776166675 1 c0000000 d62ff1f0 29586270


*/

#define START  2299755048670005ul
#define FINISH 2305479776166675ul

int main()
{
    uint32_t data[3] = { 0x80000000, 0x3e201e02, 0x61603e2b };

    for (uint64_t i = START; i <= FINISH; i += 195) {
        if ((data[0] & TRIGGER_MASK) == 0)
            printf ("R %lu 1 %x %x %x\n",
                    i, data[0], data[1], data[2]);
        transform (data, data);
    }

    return 0;
}
